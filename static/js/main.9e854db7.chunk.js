(this["webpackJsonprealm-test-app"]=this["webpackJsonprealm-test-app"]||[]).push([[0],{242:function(e,t){e.exports={toEnUsDate:function(e){return new Date(e).toLocaleString("en-US")}}},381:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=381},431:function(e,t,n){e.exports=n(509)},436:function(e,t,n){},508:function(e,t,n){},509:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(22),c=n.n(o);n(436),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var l=n(34),i=n(35),s=n(107),u=n(108),m=n(18),p=n(11),f=n.n(p),d=n(21),b=n(226),g=n(257),h=r.a.createContext("realm");n(441).config();var v="".concat("557365268660-ss6m5j9pf6nlmbojiitp36avqcf1pov6.apps.googleusercontent.com")||!1,j="".concat("Realm Test App")||!1,E="".concat("http://By-Ilya.github.io")||!1,O="".concat("realm-test-app-nmyei")||!1,w="".concat("mongodb-atlas")||!1,C="".concat("shf")||!1,y="".concat("psproject")||!1,x=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).setUser=function(e){if(a.setState({user:e}),a.state.app&&e){var t=e.mongoClient(w).db(C).collection(y);a.setState({dbCollection:t})}},a.anonymousSignIn=Object(d.a)(f.a.mark((function e(){var t,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=g.b.anonymous(),e.prev=1,e.next=4,a.state.app.logIn(t);case 4:n=e.sent,a.setUser(n),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])}))),a.onGoogleSuccessSignIn=function(e){var t=g.b.google(e.code);a.state.app.logIn(t).then((function(e){console.log("Logged in with id: ".concat(e.id)),a.setUser(e)})).catch((function(e){console.error("onGoogleSuccessSignIn:",e)}))},a.onGoogleSignInFailure=function(e){console.error("onGoogleSignInFailure:",e)},a.getUserAccessToken=Object(d.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.state.app.currentUser.refreshCustomData();case 2:return e.abrupt("return",a.state.app.currentUser.accessToken);case 3:case"end":return e.stop()}}),e)}))),a.fetchFiltersDefaultValues=Object(d.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.state.user){e.next=5;break}return e.next=3,a.state.user.functions.getFiltersDefaultValues();case 3:t=e.sent,a.setState({regionsList:t.regions.sort()||[],ownersList:t.owners.sort()||[],projectManagersList:t.projectManagers.sort()||[]});case 5:case"end":return e.stop()}}),e)}))),a.setLoadProcessing=function(e){a.setState({loadProcessing:e})},a.setProjects=function(e){a.setState({projects:e})},a.cleanLocalProjects=Object(d.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.setState({projects:[],projectWithCurrentMilestone:null});case 1:case"end":return e.stop()}}),e)}))),a.logOut=Object(d.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.state.app.currentUser.logOut();case 2:a.setUser(a.state.app.currentUser);case 3:case"end":return e.stop()}}),e)}))),a.setFilter=function(e){var t=Object(m.a)(Object(m.a)({},a.state.filter),e);a.setState({filter:t})},a.setSorting=function(e){a.setState({sort:e})},a.setProjectWithCurrentMilestone=function(e){a.setState({projectWithCurrentMilestone:e})},a.setIsEditing=function(e){a.setState({isEditing:e})},a.watcher=Object(d.a)(f.a.mark((function e(){var t,n,r,o,c,l,i;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.state.dbCollection){e.next=2;break}return e.abrupt("return");case 2:t=!0,n=!1,e.prev=4,o=function(){var e=i,t=e.clusterTime,n=e.operationType,r=e.fullDocument;if((!a.lastUpdateTime||a.lastUpdateTime<t)&&r){a.lastUpdateTime=t;var o=a.state.projects;if("replace"===n||"update"===n){var c=e.fullDocument._id;o=o.map((function(t){return t._id===c?e.fullDocument:t}))}else"insert"===n&&o.push(e.fullDocument);a.setState({projects:o})}},c=Object(b.a)(a.state.dbCollection.watch());case 7:return e.next=9,c.next();case 9:return l=e.sent,t=l.done,e.next=13,l.value;case 13:if(i=e.sent,t){e.next=19;break}o();case 16:t=!0,e.next=7;break;case 19:e.next=25;break;case 21:e.prev=21,e.t0=e.catch(4),n=!0,r=e.t0;case 25:if(e.prev=25,e.prev=26,t||null==c.return){e.next=30;break}return e.next=30,c.return();case 30:if(e.prev=30,!n){e.next=33;break}throw r;case 33:return e.finish(30);case 34:return e.finish(25);case 35:case"end":return e.stop()}}),e,null,[[4,21,25,35],[26,,30,34]])}))),a.state=Object(m.a)(Object(m.a)({},a.state),{},{googleClientId:v,realmAppId:O,appName:j,copyrightLink:E,app:new g.a(O),user:null,dbCollection:null,filter:{region:"",owner:"",project_manager:"",name:""},sort:{field:"name",order:"ASC"},regionsList:[],ownersList:[],projectManagersList:[],loadProcessing:!1,projects:null,projectWithCurrentMilestone:null,isEditing:!1}),a.funcs={setUser:a.setUser,setClient:a.setClient,anonymousSignIn:a.anonymousSignIn,onGoogleSuccessSignIn:a.onGoogleSuccessSignIn,onGoogleSignInFailure:a.onGoogleSignInFailure,getUserAccessToken:a.getUserAccessToken,logOut:a.logOut,fetchFiltersDefaultValues:a.fetchFiltersDefaultValues,setLoadProcessing:a.setLoadProcessing,setProjects:a.setProjects,cleanLocalProjects:a.cleanLocalProjects,setFilter:a.setFilter,setSorting:a.setSorting,setProjectWithCurrentMilestone:a.setProjectWithCurrentMilestone,setIsEditing:a.setIsEditing,watcher:a.watcher},a.lastUpdateTime=null,a}return Object(i.a)(n,[{key:"render",value:function(){return r.a.createElement(h.Provider,{value:Object(m.a)(Object(m.a)({},this.state),this.funcs)},this.props.children)}}]),n}(r.a.Component),k=n(403),S=n(547),I=n(529),M=n(530),P=n(284),T=n(404),N=n.n(T),R=n(100),D=n(356),L=n(355),F=n(528),_=Object(L.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},submit:{margin:e.spacing(3,0,2)},signInForm:{width:"100%",marginTop:e.spacing(1),display:"flex",justifyContent:"center"},errorBox:{width:"100%",marginTop:e.spacing(1),display:"flex",justifyContent:"center"}}}));function U(e){var t=e.googleClientId,n=e.appName,a=e.copyrightLink,o=e.onSuccess,c=e.onFailure,l=e.anonymousSignIn,i=e.signInError,s=_();return r.a.createElement(F.a,{component:"main",maxWidth:"xs"},r.a.createElement(I.a,null),r.a.createElement("div",{className:s.paper},r.a.createElement(S.a,{className:s.avatar},r.a.createElement(N.a,null)),r.a.createElement(R.a,{component:"h1",variant:"h5"},"Sign in"),r.a.createElement(D.a,{type:"submit",variant:"contained",color:"primary",className:s.submit,onClick:l},"Anonymous user"),r.a.createElement("div",{className:s.signInForm},r.a.createElement(k.GoogleLogin,{clientId:t,buttonText:"Sign in with Google",onSuccess:o,onFailure:c,scope:"email profile",responseType:"code"})),r.a.createElement("div",{className:s.signInForm}),i&&r.a.createElement("div",{className:s.errorBox},r.a.createElement(R.a,{variant:"body2",color:"error",align:"center"},i))),r.a.createElement(P.a,{mt:8},r.a.createElement(B,{appName:n,copyrightLink:a})))}function B(e){var t=e.appName,n=e.copyrightLink;return r.a.createElement(R.a,{variant:"body2",color:"textSecondary",align:"center"},"Copyright \xa9 ",r.a.createElement(M.a,{color:"inherit",href:n},t)," ",(new Date).getFullYear(),".")}U.defaultProps={signInError:null};var V=n(40),A=n(130),G=n(38),W=n(15),K=n(536),z=n(357),H=n(294),$=n(358),q=n(220),J=n(241),Q=n.n(J),Y=n(236),X=n.n(Y),Z=n(425);function ee(e){var t=e.classes,n=e.inputPlaceHolder,a=e.onKeyDown,o=t.searchContainer,c=t.searchIcon,l=t.inputBaseRoot,i=t.inputBaseInput;return r.a.createElement("div",{className:o},r.a.createElement("div",{className:c},r.a.createElement(X.a,null)),r.a.createElement(Z.a,{placeholder:n,classes:{root:l,input:i},inputProps:{"aria-label":"search"},onKeyDown:a}))}var te=n(531),ne=n(533),ae=n(534),re=n(535),oe=n(292),ce=n(293),le=n(299),ie=n(238);function se(e){var t=e.classes,n=e.filterButtonText,o=e.filterDialogTitle,c=e.filtersObject,l=e.applyButtonText,i=e.onApplyFilters,s=e.showEmptyValue,u=t.formContainer,m=Object(a.useState)(!1),p=Object(V.a)(m,2),f=p[0],d=p[1],b=function(){d(!1)};return r.a.createElement("div",{className:u},r.a.createElement(D.a,{onClick:function(){d(!0)},variant:"contained"},n),r.a.createElement(te.a,{disableBackdropClick:!0,disableEscapeKeyDown:!0,open:f,onClose:b},r.a.createElement(ne.a,null,o),r.a.createElement(ae.a,null,r.a.createElement("form",{className:u},c.map((function(e){return r.a.createElement(ue,{classes:{formControl:t.formControl},label:e.label,currentValue:e.currentValue,values:e.values,setValue:e.setValue,showEmptyValue:s})})))),r.a.createElement(re.a,null,r.a.createElement(D.a,{onClick:b,color:"primary"},"Cancel"),r.a.createElement(D.a,{onClick:function(){i(),d(!1)},color:"primary"},l))))}function ue(e){var t=e.classes,n=e.label,a=e.currentValue,o=e.values,c=e.setValue,l=e.showEmptyValue,i=t.formControl;return r.a.createElement(oe.a,{className:i},r.a.createElement(ce.a,{htmlFor:"demo-dialog-native"},n),r.a.createElement(le.a,{native:!0,value:a,onChange:c,input:r.a.createElement(ie.a,{id:"demo-dialog-native"})},l&&r.a.createElement("option",{value:""}),o.map((function(e){return r.a.createElement("option",{value:e},e)}))))}var me=n(406),pe=n.n(me);function fe(e){var t=e.classes,n=e.menuId,a=e.mobileMenuId,o=e.onProfileMenuOpen,c=e.onMobileMenuOpen,l=t.sectionDesktop,i=t.sectionMobile;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:l},r.a.createElement(H.a,{edge:"end","aria-label":"account of current user","aria-controls":n,"aria-haspopup":"true",onClick:o,color:"inherit"},r.a.createElement(Q.a,null))),r.a.createElement("div",{className:i},r.a.createElement(H.a,{"aria-label":"show more","aria-controls":a,"aria-haspopup":"true",onClick:c,color:"inherit"},r.a.createElement(pe.a,null))))}var de=Object(L.a)((function(e){return{grow:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:Object(G.a)({display:"none"},e.breakpoints.up("sm"),{display:"block"}),search:Object(G.a)({position:"relative",borderRadius:e.shape.borderRadius,backgroundColor:Object(W.d)(e.palette.common.white,.15),"&:hover":{backgroundColor:Object(W.d)(e.palette.common.white,.25)},marginRight:e.spacing(2),marginLeft:0,width:"100%"},e.breakpoints.up("sm"),{marginLeft:e.spacing(3),width:"auto"}),searchIcon:{padding:e.spacing(0,2),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"},inputRoot:{color:"inherit"},inputInput:Object(G.a)({padding:e.spacing(1,1,1,0),paddingLeft:"calc(1em + ".concat(e.spacing(4),"px)"),transition:e.transitions.create("width"),width:"100%"},e.breakpoints.up("md"),{width:"20ch"}),formContainer:{marginLeft:e.spacing(2)},formControl:{margin:e.spacing(1),minWidth:120},sectionDesktop:Object(G.a)({display:"none"},e.breakpoints.up("md"),{display:"flex"}),sectionMobile:Object(G.a)({display:"flex"},e.breakpoints.up("md"),{display:"none"})}}));function be(e){var t=de(),n=e.fetchProjects,o=Object(a.useContext)(h),c=o.filter,l=o.setFilter,i=o.sort,s=o.setSorting,u=o.regionsList,p=o.ownersList,b=o.projectManagersList,g=o.fetchFiltersDefaultValues,v=o.setLoadProcessing,j=o.logOut;Object(a.useEffect)((function(){g()}),[]),Object(a.useEffect)((function(){v(!0),n({needToClean:!0})}),[c,i]);var E=Object(a.useState)(c),O=Object(V.a)(E,2),w=O[0],C=O[1],y=[{label:"Region",currentValue:w.region,values:u,setValue:function(e){C(Object(m.a)(Object(m.a)({},w),{},{region:e.target.value}))}},{label:"Owner",currentValue:w.owner,values:p,setValue:function(e){C(Object(m.a)(Object(m.a)({},w),{},{owner:e.target.value}))}},{label:"PM",currentValue:w.project_manager,values:b,setValue:function(e){C(Object(m.a)(Object(m.a)({},w),{},{project_manager:e.target.value}))}}],x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;void 0!==e?(C(Object(m.a)(Object(m.a)({},w),{},{name:e})),l(Object(m.a)(Object(m.a)({},w),{},{name:e}))):l(w)},k=Object(a.useState)(i),S=Object(V.a)(k,2),I=S[0],M=S[1],P=[{label:"Field",currentValue:I.field,values:["name","region","owner"],setValue:function(e){M(Object(m.a)(Object(m.a)({},I),{},{field:e.target.value}))}},{label:"Order",currentValue:I.order,values:["ASC","DESC"],setValue:function(e){M(Object(m.a)(Object(m.a)({},I),{},{order:e.target.value}))}}],T=function(){var e=Object(d.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"Enter"===t.key&&x(t.target.value);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),N="primary-search-account-menu",D=r.a.useState(null),L=Object(V.a)(D,2),F=L[0],_=L[1],U=r.a.useState(null),B=Object(V.a)(U,2),A=B[0],G=B[1],W=Boolean(F),H=Boolean(A),$=function(e){_(e.currentTarget)},q=function(){G(null)},J=function(){_(null),q()};return r.a.createElement("div",{className:t.grow},r.a.createElement(K.a,{position:"fixed"},r.a.createElement(z.a,null,r.a.createElement(R.a,{className:t.title,variant:"h6",noWrap:!0},"Projects"),r.a.createElement(ee,{classes:{searchContainer:t.search,searchIcon:t.searchIcon,inputBaseRoot:t.inputRoot,inputBaseInput:t.inputInput},inputPlaceHolder:"Search projects",onKeyDown:T}),r.a.createElement(se,{classes:{formContainer:t.formContainer,formControl:t.formControl},filterButtonText:"Filters",filterDialogTitle:"Filter projects",filtersObject:y,applyButtonText:"Apply filters",onApplyFilters:x,showEmptyValue:!0}),r.a.createElement(se,{classes:{formContainer:t.formContainer,formControl:t.formControl},filterButtonText:"Sort",filterDialogTitle:"Sort projects",filtersObject:P,applyButtonText:"Sort",onApplyFilters:function(){s(I)},showEmptyValue:!1}),r.a.createElement("div",{className:t.grow}),r.a.createElement(fe,{classes:{sectionDesktop:t.sectionDesktop,sectionMobile:t.sectionMobile},menuId:N,mobileMenuId:"primary-search-account-menu-mobile",onProfileMenuOpen:$,onMobileMenuOpen:function(e){G(e.currentTarget)}}))),r.a.createElement(he,{mobileMoreAnchorEl:A,mobileMenuId:"primary-search-account-menu-mobile",isMobileMenuOpen:H,onMobileMenuClose:q,onProfileMenuOpen:$}),r.a.createElement(ge,{anchorEl:F,menuId:N,isMenuOpen:W,onMenuClose:J,onLogOut:function(){j(),J()}}))}function ge(e){var t=e.anchorEl,n=e.menuId,a=e.isMenuOpen,o=e.onMenuClose,c=e.onLogOut;return r.a.createElement(q.a,{anchorEl:t,anchorOrigin:{vertical:"top",horizontal:"right"},id:n,keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"right"},open:a,onClose:o},r.a.createElement($.a,{onClick:c},"Log Out"))}function he(e){var t=e.mobileMoreAnchorEl,n=e.mobileMenuId,a=e.isMobileMenuOpen,o=e.onMobileMenuClose,c=e.onProfileMenuOpen;return r.a.createElement(q.a,{anchorEl:t,anchorOrigin:{vertical:"top",horizontal:"right"},id:n,keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"right"},open:a,onClose:o},r.a.createElement($.a,{onClick:c},r.a.createElement(H.a,{"aria-label":"account of current user","aria-controls":"primary-search-account-menu","aria-haspopup":"true",color:"inherit"},r.a.createElement(Q.a,null)),r.a.createElement("p",null,"Profile")))}var ve=n(520),je=n(540),Ee=n(521),Oe=n(360),we=n(537),Ce=n(538),ye=n(539),xe=n(359),ke=n(242),Se=Object(L.a)({root:{width:"55vh",marginBottom:5},info:{display:"inline-block",width:"100%"},leftInfo:{float:"left"},rightInfo:{float:"right"},title:{fontSize:14},pos:{marginBottom:12}});function Ie(e){var t=Se(),n=e.psproject,o=Object(a.useContext)(h).setProjectWithCurrentMilestone;return r.a.createElement(we.a,{className:t.root},r.a.createElement(Ce.a,null,r.a.createElement("div",{className:t.info},r.a.createElement("div",{className:t.leftInfo},r.a.createElement(R.a,{className:t.title,color:"textSecondary",gutterBottom:!0},n.account)),r.a.createElement("div",{className:t.rightInfo},r.a.createElement(R.a,{className:t.title,color:"textSecondary",gutterBottom:!0},n.region))),r.a.createElement(R.a,{variant:"h5",component:"h2"},n.name),r.a.createElement("div",{className:t.info},r.a.createElement("div",{className:t.leftInfo},r.a.createElement(R.a,{className:t.pos,color:"textSecondary",gutterBottom:!0},"Owner: ",n.owner)),r.a.createElement("div",{className:t.rightInfo},r.a.createElement(R.a,{className:t.pos,color:"textSecondary",gutterBottom:!0},"PM: ",n.project_manager))),r.a.createElement(R.a,{variant:"body2",component:"p"},r.a.createElement("b",null,"Stage:")," ",n.details.pm_stage),r.a.createElement(R.a,{variant:"body2",component:"p"},r.a.createElement("b",null,"Status:")," ",n.details.pm_project_status),r.a.createElement(R.a,{variant:"body2",component:"p"},r.a.createElement("b",null,"Expires:")," ",Object(ke.toEnUsDate)(n.details.product_end_date)),r.a.createElement(ye.a,null),r.a.createElement(Me,{milestones:n.milestones,onClickMilestone:function(e){o({projectId:n._id,milestoneId:e._id})}})))}function Me(e){var t=e.milestones,n=e.onClickMilestone;return r.a.createElement(ve.a,{subheader:r.a.createElement("li",null)},r.a.createElement(je.a,null,"Milestones"),t.map((function(e){return r.a.createElement(Ee.a,{button:!0,onClick:function(){return n(e)}},r.a.createElement(xe.a,{primary:e.name}))})))}function Pe(e){var t=e.classes,n=Object(a.useContext)(h),o=n.loadProcessing,c=n.projects;return r.a.createElement(ve.a,{component:"nav",className:t.listRoot,"aria-label":"contacts"},r.a.createElement(je.a,{color:"primary"},r.a.createElement(R.a,{variant:"h5"},"Total projects: ",c?c.length:0)),o&&r.a.createElement(Ee.a,null,r.a.createElement(Oe.a,null)),!o&&c&&c.map((function(e){return r.a.createElement(Ee.a,null,r.a.createElement(Ie,{psproject:e}))})))}var Te=n(545),Ne=n(152),Re=n(122),De=n(295),Le=n.n(De),Fe=n(409),_e=n.n(Fe),Ue=n(418),Be=n.n(Ue),Ve=n(410),Ae=n.n(Ve),Ge=n(417),We=n.n(Ge),Ke=n(302),ze=n.n(Ke),He=n(301),$e=n.n(He),qe=n(411),Je=n.n(qe),Qe=n(412),Ye=n.n(Qe),Xe=n(414),Ze=n.n(Xe),et=n(415),tt=n.n(et),nt=n(416),at=n.n(nt),rt=n(419),ot=n.n(rt),ct=n(413),lt=n.n(ct),it=n(420),st=n.n(it);function ut(e){var t=e.onClickEditButton;return{Add:Object(a.forwardRef)((function(e,t){return r.a.createElement(_e.a,Object.assign({},e,{ref:t}))})),Check:Object(a.forwardRef)((function(e,t){return r.a.createElement(Ae.a,Object.assign({},e,{ref:t}))})),Clear:Object(a.forwardRef)((function(e,t){return r.a.createElement($e.a,Object.assign({},e,{ref:t}))})),Delete:Object(a.forwardRef)((function(e,t){return r.a.createElement(Je.a,Object.assign({},e,{ref:t}))})),DetailPanel:Object(a.forwardRef)((function(e,t){return r.a.createElement(ze.a,Object.assign({},e,{ref:t}))})),Edit:Object(a.forwardRef)((function(e,n){return r.a.createElement(Ye.a,Object.assign({},e,{ref:n,onClick:t}))})),Export:Object(a.forwardRef)((function(e,t){return r.a.createElement(lt.a,Object.assign({},e,{ref:t}))})),Filter:Object(a.forwardRef)((function(e,t){return r.a.createElement(Ze.a,Object.assign({},e,{ref:t}))})),FirstPage:Object(a.forwardRef)((function(e,t){return r.a.createElement(tt.a,Object.assign({},e,{ref:t}))})),LastPage:Object(a.forwardRef)((function(e,t){return r.a.createElement(at.a,Object.assign({},e,{ref:t}))})),NextPage:Object(a.forwardRef)((function(e,t){return r.a.createElement(ze.a,Object.assign({},e,{ref:t}))})),PreviousPage:Object(a.forwardRef)((function(e,t){return r.a.createElement(We.a,Object.assign({},e,{ref:t}))})),ResetSearch:Object(a.forwardRef)((function(e,t){return r.a.createElement($e.a,Object.assign({},e,{ref:t}))})),Search:Object(a.forwardRef)((function(e,t){return r.a.createElement(X.a,Object.assign({},e,{ref:t}))})),SortArrow:Object(a.forwardRef)((function(e,t){return r.a.createElement(Be.a,Object.assign({},e,{ref:t}))})),ThirdStateCheck:Object(a.forwardRef)((function(e,t){return r.a.createElement(ot.a,Object.assign({},e,{ref:t}))})),ViewColumn:Object(a.forwardRef)((function(e,t){return r.a.createElement(st.a,Object.assign({},e,{ref:t}))}))}}function mt(e){var t=e.projectId,n=e.tableName,o=e.currentColumns,c=e.currentData,l=e.onUpdate,i=Object(a.useContext)(h),s=i.isEditing,u=i.setIsEditing,m=Object(a.useState)(o),p=Object(V.a)(m,2),b=p[0],g=p[1],v=Object(a.useState)(c),j=Object(V.a)(v,2),E=j[0],O=j[1];Object(a.useEffect)((function(){!s&&g(o)}),[s,t,o]),Object(a.useEffect)((function(){!s&&O(c)}),[s,t,c]);return r.a.createElement(Le.a,{title:n,icons:ut({onClickEditButton:function(){return u(!0)}}),columns:b,data:E,editable:{isEditable:function(e){return e.editable},onRowUpdate:function(){var e=Object(d.a)(f.a.mark((function e(t,n){var a,r,o,c;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=t.tableKey,r=t.updateKey,e.next=4,l({updateKey:r,value:t[a]});case 4:o=Object(Re.a)(E),c=n.tableData.id,o[c]=t,O(Object(Re.a)(o)),u(!1),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),console.error(e.t0),u(!1);case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t,n){return e.apply(this,arguments)}}(),onRowUpdateCancelled:function(){return u(!1)}}})}function pt(e){var t=e.classes,n=e.project,o=Object(a.useContext)(h).dbCollection,c=function(e){if(!e)return{milestonesTableColumns:[],milestonesTableRows:[]};var t=e.owner,n=e.region,a=e.project_manager,r=e.account,o=e.name,c=e.opportunity,l=e.details,i=e.currentMilestone;return{milestonesTableColumns:[{title:"Project / Milestone Fields",field:"name",editable:"never"},{title:"Value",field:"value",editable:"onUpdate"}],milestonesTableRows:[{name:"Project Owner",value:t,editable:!1},{name:"Region",value:n,editable:!1},{name:"Project Manager",value:a,editable:!1},{name:"PM Stage",value:l.pm_stage,editable:!0,tableKey:"value",updateKey:"details.pm_stage"},{name:"Account",value:r,editable:!1},{name:"Opportunity",value:c.name,editable:!1},{name:"PS Project Name",value:o,editable:!1},{name:"Milestone Name",value:i.name,editable:!1},{name:"Country",value:i.country,editable:!1},{name:"Milestone amount",value:i.base.milestone_amount,editable:!1},{name:"Gap Hours",value:i.base.gap_hours,editable:!1}]}}(n),l=c.milestonesTableColumns,i=c.milestonesTableRows,s=function(e){return e?{scheduleTableColumns:[{title:"Date",field:"date",editable:"never"},{title:"Scheduled",field:"scheduled",editable:"never"},{title:"Hours",field:"hours",editable:"never"}],scheduleTableRows:e.currentMilestone.schedule.map((function(e){return{date:Object(ke.toEnUsDate)(e.week),scheduled:e.revenue?"$ ".concat(e.revenue):"-",hours:e.hours?e.hours:"-",editable:!1}}))}:{scheduleTableColumns:[],scheduleTableRows:[]}}(n),u=s.scheduleTableColumns,m=s.scheduleTableRows,p=function(){var e=Object(d.a)(f.a.mark((function e(t){var a,r,c,l,i;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.updateKey,r=t.value,c={_id:n._id},l={$set:Object(G.a)({},a,r)},i={upsert:!1},e.next=6,o.updateOne(c,l,i);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,0!==i.length&&r.a.createElement("div",{className:t.tableContainer},r.a.createElement(mt,{projectId:n._id,tableName:"Project milestone info",currentColumns:l,currentData:i,onUpdate:p})),0!==m.length&&r.a.createElement("div",{className:t.tableContainer},r.a.createElement(mt,{projectId:n._id,tableName:"Schedule",currentColumns:u,currentData:m})))}var ft=Object(L.a)({tableContainer:{marginTop:"20px"}});function dt(e){var t=ft(),n=e.classes,o=Object(a.useContext)(h),c=o.projectWithCurrentMilestone,l=o.projects,i=null,s=null;if(c){var u=c.projectId,p=c.milestoneId,f=l.filter((function(e){return e._id===u}));if(f&&f.length){var d=(i=f[0]).milestones.filter((function(e){return e._id===p}));s=d&&d.length?d[0]:null}}return r.a.createElement(Te.a,{container:!0},r.a.createElement(Te.a,{item:!0,xs:12},r.a.createElement(Ne.a,{className:n.paper},r.a.createElement(R.a,{variant:"h4",gutterBottom:!0},"Milestones overview"),r.a.createElement(ye.a,null),i&&s?r.a.createElement(pt,{classes:t,project:Object(m.a)(Object(m.a)({},i),{},{currentMilestone:s})}):r.a.createElement("div",{className:t.tableContainer},r.a.createElement(R.a,{variant:"body1"},"Click on project milestone to see an overview...")))))}var bt=Object(L.a)((function(e){return{container:{marginTop:70,display:"flex",flexDirection:"row"},root:{width:"90vh",backgroundColor:e.palette.background.paper,position:"relative",overflow:"auto",minHeight:"90vh",height:"90vh"},paper:{padding:e.spacing(1),textAlign:"center",color:e.palette.text.primary,whiteSpace:"normal",marginBottom:e.spacing(1),marginLeft:e.spacing(2),marginRight:e.spacing(1),maxHeight:"90vh",overflow:"auto"}}}));function gt(){var e=bt();return r.a.createElement("div",{className:e.container},r.a.createElement(Pe,{classes:{listRoot:e.root}}),r.a.createElement(dt,{classes:{paper:e.paper}}))}var ht=n(421),vt=n(120);function jt(){var e=Object(ht.a)(["\n    query FindProjectsCustomResolver($filtersInput: FiltersInput!) {\n        psprojectsData(input: $filtersInput) {\n            _id\n            account\n            active\n            details {\n                pm_stage\n                pm_project_status\n                product_end_date\n            }\n            opportunity {\n                name\n                owner\n                engagement_manager\n            }\n            milestones {\n                _id\n                country\n                currency\n                name\n                base {\n                    milestone_amount\n                    gap_hours\n                }\n                schedule {\n                    week\n                    revenue\n                    hours\n                }\n            }\n            name\n            owner\n            project_manager\n            region\n            stage\n        }\n    }\n"]);return jt=function(){return e},e}var Et=n.n(vt)()(jt());function Ot(){var e=Object(a.useContext)(h),t=e.setProjects,n=e.setLoadProcessing,o=e.cleanLocalProjects,c=e.filter,l=e.sort,i=e.watcher,s={variables:{filtersInput:{filter:Object(m.a)(Object(m.a)({},c),{},{active:!0}),sort:{field:l.field,order:"DESC"===l.order?-1:1}}}},u=Object(A.useLazyQuery)(Et,Object(m.a)(Object(m.a)({},s),{},{onCompleted:function(e){t(e.psprojectsData),n(!1)},onError:function(e){console.error(e)},fetchPolicy:"network-only"})),p=Object(V.a)(u,1)[0],b=function(){var e=Object(d.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.needToClean,e.t0=n,!e.t0){e.next=5;break}return e.next=5,o();case 5:return e.next=7,p();case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g=setTimeout(function(){var e=Object(d.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g&&clearTimeout(g),e.next=3,i();case 3:g=setTimeout(t,5e3);case 4:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),5e3);return r.a.createElement(r.a.Fragment,null,r.a.createElement(be,{fetchProjects:b}),r.a.createElement(gt,null))}function wt(){var e=Object(a.useContext)(h),t=e.realmAppId,n=e.getUserAccessToken,o=e.user,c=Object(a.useState)(Ct(t,n)),l=Object(V.a)(c,2),i=l[0],s=l[1];return Object(a.useEffect)((function(){s(Ct(t,n))}),[o]),r.a.createElement(A.ApolloProvider,{client:i},r.a.createElement(Ot,null))}function Ct(e,t){var n="https://realm.mongodb.com/api/client/v2.0/app/".concat(e,"/graphql");return new A.ApolloClient({link:new A.HttpLink({uri:n,fetch:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=Object(d.a)(f.a.mark((function e(n,a){var r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t();case 2:return r=e.sent,a.headers.Authorization="Bearer ".concat(r),e.abrupt("return",fetch(n,a));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}),cache:new A.InMemoryCache})}function yt(){var e=Object(a.useContext)(h),t=e.app,n=e.appName,o=e.copyrightLink,c=e.googleClientId,l=e.anonymousSignIn,i=e.user,s=e.setUser,u=e.onGoogleSuccessSignIn,m=e.onGoogleSignInFailure,p=Object(a.useRef)(t);return Object(a.useEffect)((function(){s(t.currentUser)}),[p.current.currentUser]),r.a.createElement(r.a.Fragment,null,!i&&r.a.createElement(U,{onSuccess:u,appName:n,copyrightLink:o,googleClientId:c,onFailure:m,anonymousSignIn:l}),i&&r.a.createElement(wt,null))}n(508);var xt=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement(x,null,r.a.createElement(yt,null)))}}]),n}(a.Component);c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(xt,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[431,1,2]]]);
//# sourceMappingURL=main.9e854db7.chunk.js.map